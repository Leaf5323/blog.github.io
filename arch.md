# 从认识Arch到Arch的安装

> KISS原则：Keep It Simple and Stupid.

## 认识Arch

### ![icon](./img/favicon.png) 缘起Ubuntu

若干年前，在Deepin和Mint还没有成名的日子，如果你想要接触Linux，那么一般第一个了解到的一定是一个名为Ubuntu的发行版。当你兴奋地下载iso镜像，刷写到U盘，安装完成，开机，看到的总是那个橙红主题色壁纸的界面。打开的第一个软件不出意外总是Firefox，使用的第一个终端命令不出意外总是

`sudo apt install XXX`

我便是如此，作为一个连小白都不算的Windows用户，初识Ubuntu那会连apt换源都不会，这个门槛就已经多次导致我失去兴趣直接关机。后来明白包管理器应该更换所在地区的镜像源，换源后终于可以正常地更新系统并安装一些软件。但是，当我想要稍微深入一点，比如安装官方源中没有的主题或者软件，很多时候我发现我需要手动添加PPA，结果PPA就没有人好心给你镜像了，又得忍受直连国外服务器龟速的下载。若干次后，我彻底被劝退，同时对Ubuntu主观地表示反感。

### ![icon](./img/manjaro.png) 寻找我♥的发行版 

又是若干年后，不知什么原因我又接触了Linux，这一次稍微上道一点了，先尝试搜索了除Ubuntu以外的发行版，找到了Debian和Mint（那会算是小有名气），然后分别安装到电脑上尝试，发现出现问题的地方和Ubuntu如出一辙。后来明白我找的居然全是Debian系的发行版（鬼知道为什么就这么巧🤬），由于都用apt包管理器所以问题肯定都是一样的，于是我开始寻找Debain系之外的发行版。很快就找到了Fedora，centOS和Arch，分别安装尝试前两者之后发现和Ubuntu感觉差不了太多，但是不知道是不是比较小众的原因，两个发行版国内都找不到什么教程，于是我只好把希望放在最后的Arch上面。

当我和安装先前几个发行版时一样下载iso时，我惊叹Arch没有前几个发行版动辄几个G的臃肿，镜像只有几百MB。惊叹之余刷写好U盘，重启进安装镜像，我人傻了：~~没有漂亮的界面~~ 根本就没有图形界面，只有命令行光标停留在`root@archiso~#`后面等待输入。起初我以为是硬件问题导致的图形界面启动失败，重启了若干次并没有变化。接着我以为是版本下错下成了命令行版本，又跑到Arch官网找了半天无果。上网一查发现根本Arch只能命令行手动安装，还异常复杂，直接给我劝退。我老老实实地寻找基于Arch的其他发行版，找来找去只找到一个Manjaro（那时也还不太出名），小心翼翼进入Manjaro官网，发现这个发行版是有图形界面的。下载镜像正常安装之后，体验相当不错，一切都源自那个简单又万能的pacman包管理器。简单换源之后，更新系统安装软件用pacman实在太过于ez，如果想要安装第三方应用，绝大多数情况下只需要启用AUR，找对包名就可以下载安装了。（一个pacman定终身！💕）同时，由于滚动更新的机制，Arch系的Linux没有大的发行版本变动，也免去像Ubuntu每四年一个LTS版本的多余，每天只需要终端一句`sudo pacman -Syyu`就可以保证整个系统都是最新的状态，这一点很戳我这个更新Maniac。

从那之后，我很长一段时间都在用Manjaro，在使用的过程中也不断进行着对于Arch系发行版探寻，因为我觉得可能还有比Manjaro这一发行版更好的其他Arch系Linux，结果找了半天都是些“半死不活”的发行版，比不上Manjaro这样拥有多个发行版本与良好的社区活力。但是，问题来了，用了很久Manjaro仍然没有释然的感觉：那个最开始就将我拒之门外的“原生”Arch，会有怎样的使用体验？

种草成功，我开始搜集相关的资料。首先我弄明白了Manjaro和Arch的关系：简单来说，Manjaro是基于Arch制作的预装了桌面环境和一些软件的发行版，而Arch则是完全由用户自己配置安装，完全纯净，系统仅包含用户安装的内容。经过一番思想斗争之后，我终于卖出那一步，在网上查找Arch的安装教程，自己试一试安装个Arch看看。

## 安装Arch

### ![icon](./img/arch.ico) 万能的Arch Wiki

就我个人来说，我是通过第三方的教程才了解到Arch Wiki这个厉害的百科。官方其实有非常详细地 ~~用英语~~ 手把手教你怎么安装系统、怎么安装驱动、怎么个性化UI等等，霎时间我才明白这个门槛想让我明白的道理：
>**当你冷静下来耐心去认真阅读Wiki，很多问题其实都可以自己解决，浮躁解决不了问题。**

这里贴出来[ArchWiki](https://wiki.archlinux.org/)，有时候即使不是Arch系的Linux，遇到麻烦可以在这个Wiki里面找找，说不定会给你解决的思路。

下面就是我整理的安装的步骤了，虽然来源是第三方，但基本上都是参考官方的Wiki，乍一看很繁琐，仔细看其实是有很强的逻辑性的，我也会尽量做到有条理地记录，建议顺序阅读。

### ![icon](./img/arch.ico) 前期准备

关于下载iso镜像就不多赘述，刷写用的U盘最好是8G以上，不过鉴于Arch苗条的安装镜像，或许4G也可以，但是*本人没有测试过*。刷写工具推荐使用[Rufus](http://rufus.ie/)，界面简洁明了，还可以自动帮你配置好U盘的启动引导。

准备🆗之后就可以重启电脑，怎么选启动设备这里不过多赘述，如果必要的话可以去BIOS里把U盘设为启动首选项，选择U盘启动，等待Arch安装盘启动，待见到`root@archiso~#`差不多就算是前期准备完成了

>注：安装盘默认使用root用户登录，所以这里开始的指令默认都是#下执行，如果不明白我在说什么直接按照代码框里面的内容输入就可以了

### ![icon](./img/arch.ico) 硬件配置

这里的硬件包括网络配置和硬盘配置。

>啊啊，忘了说了，没有网络连接的话是不能安装Arch的，不过看到这里一般都是由网络连接的吧？

#### 有线网络连接

这个就很ez了，只需输入

```bash
dhcpcd
```

提示文字在没有出现错误的时候不需要看，接着只用ping一下某个网站验证网络连接成功就好了，参考代码如下

```bash
ping baidu.com
```

但是这个命令默认不会自己中止的，确认连接没有问题之后使用组合键`Ctrl`+`C`就可以中止ping指令的运行了

>注：一般情况下，`Ctrl`+`C`组合键的功能都是强制终止当前命令，后面的过程可能会遇到网络问题下载卡住，到时候可以用这个组合键强制终止，然后重新输入终止的指令即可

#### 无线网路连接

和上面的不太一样，我们使用如下命令

```bash
wifi-menu
```

然后跟随引导选择可用的WiFi，连接后同样执行一下ping指令确保网络连接正常，然后我们就可以进行下一步了

#### 更新系统时钟

输入指令即可，无需多言

```bash
timedatectl set-ntp true
```

#### 磁盘配置

首先要罗列出你的磁盘信息，使用如下命令

```bash
fdisk -l
```

这时你可以从返回信息里看到磁盘及其分区情况，找到你想要安装Arch的磁盘，记住磁盘号，一般会被系统记录为如下格式

```
/dev/sdX 
注：上面的X一般为数字1,2,3...
```

找到磁盘后（这里假定为`/dev/sdX`）使用如下指令开始对磁盘进行分区

```bash
fdisk /dev/sdX
```

你会进入fdisk的编辑模式
这里会有两个分支